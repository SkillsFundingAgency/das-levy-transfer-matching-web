@using SFA.DAS.LevyTransferMatching.Domain.Extensions

@model SFA.DAS.LevyTransferMatching.Web.Models.Applications.ApplicationViewModel

@{
    ViewData["Title"] = Model.Title;

    var accept = SFA.DAS.LevyTransferMatching.Web.Models.Applications.ApplicationPostRequest.ApprovalAction.Accept;
    var decline = SFA.DAS.LevyTransferMatching.Web.Models.Applications.ApplicationPostRequest.ApprovalAction.Decline;
    var withdraw = SFA.DAS.LevyTransferMatching.Web.Models.Applications.ApplicationPostRequest.ApprovalAction.Withdraw;
    var none = SFA.DAS.LevyTransferMatching.Web.Models.Applications.ApplicationPostRequest.ApprovalAction.None;
}

<a href="@Url.Action("Applications", new { EncodedAccountId = Model.EncodedAccountId })" class="govuk-back-link">Back</a>
<main class="govuk-main-wrapper govuk-main-wrapper--auto-spacing" id="main-content">
    <partial name="_ValidationSummary" />
    <div class="govuk-grid-row">
        <div class="govuk-grid-column-two-thirds">

            <h1 class="govuk-heading-xl">@Model.Title</h1>

            <div class="govuk-warning-text application-status-one">
                <span class="govuk-warning-text__icon" aria-hidden="true">!</span>
                <strong class="govuk-warning-text__text">
                    <span class="govuk-warning-text__assistive">Warning</span>
                    Application status: <span class="@Model.Status.GetCssClassForReceiver()">@Model.Status.GetLabelForReceiver()</span>
                </strong>
            </div>

            @if (Model.DisplayCurrentFundsBalance)
            {
                <div>
                    <h2 class="govuk-heading-m">Current funds balance</h2>
                    <section class="das-highlight">
                        <dl class="govuk-body app-dl-inline">
                            <dt class="app-dl-inline__title--strong">Accepted</dt>
                            <dd class="app-dl-inline__definition">@Model.EstimatedTotalCost</dd>
                            <dt class="app-dl-inline__title--strong">Used</dt>
                            <dd class="app-dl-inline__definition">@Model.AmountUsed</dd>
                            <dt class="app-dl-inline__title--strong">Remaining</dt>
                            <dd class="app-dl-inline__definition">@Model.AmountRemaining</dd>
                            <dt class="app-dl-inline__title--strong">Apprentices</dt>
                            <dd class="app-dl-inline__definition">@Model.NumberOfApprenticesRemaining remaining</dd>
                        </dl>
                    </section>
                </div>
            }

            <div class="accepted-text-hide">
                <h2 class="govuk-heading-m">About your apprenticeship training</h2>
            </div>

            <section class="das-highlight">
                <p><strong>Apprenticeship training course:</strong> @Model.JobRole</p>
                <p><strong>Number of apprentices:</strong> @Model.NumberOfApprentices</p>
                <p><strong>Estimated total cost:</strong> @Model.EstimatedTotalCost</p>
                <p class="govuk-!-margin-bottom-0"><strong>Apprenticeship training to start by:</strong> @Model.StartBy.ToString("MM/yyyy")</p>
            </section>

            <partial name="_ApplicationCanAcceptFundingPartial" model="Model" />

            <partial name="_ApplicationCanUseTransferFundsPartial" model="Model" />

            @if (Model.CanWithdraw)
            {
                <form method="post">
                    <div class="govuk-form-group" das-highlight-error-for="SelectedAction" error-class="govuk-form-group--error">
                        <fieldset class="govuk-fieldset">
                            <legend class="govuk-fieldset__legend govuk-fieldset__legend--m">
                                Do you want to withdraw this application?
                            </legend>
                            <span das-validation-for="SelectedAction" class="govuk-error-message"></span>
                            <div class="govuk-radios govuk-radios--conditional" data-module="govuk-radios">
                                <div class="govuk-radios__item">
                                    <input class="govuk-radios__input" id="SelectedAction" name="SelectedAction" asp-for="SelectedAction" type="radio" value="@withdraw" das-highlight-error-for="SelectedAction" error-class="govuk-textarea--error" data-aria-controls="approval-content" />
                                    <label class="govuk-label govuk-radios__label" for="SelectedAction">
                                        Yes, withdraw the application
                                    </label>
                                </div>
                                <div class="govuk-radios__item">
                                    <input class="govuk-radios__input" id="SelectedAction-2" name="SelectedAction" asp-for="SelectedAction" type="radio" value="@none" das-highlight-error-for="SelectedAction" error-class="govuk-textarea--error" />
                                    <label class="govuk-label govuk-radios__label" for="SelectedAction-2">
                                        No, keep this application and return to my applications
                                    </label>
                                </div>
                            </div>
                        </fieldset>
                    </div>
                    <div class="govuk-button-group">
                        <button class="govuk-button" data-module="govuk-button" type="submit">Continue</button>
                    </div>
                </form>
            }

        </div>

        <div class="govuk-grid-column-one-third">
            <partial name="_OpportunitySummary" for="OpportunitySummaryViewModel" />
        </div>

    </div>

</main>